(function inject(a,b,c){function d(a,b){return this instanceof d?(this.set(a||0,b||0),void 0):new d(a,b)}d.prototype={change:function(a){if(a)this.observers?this.observers.push(a):this.observers=[a];else if(this.observers)for(var b=this.observers.length-1;b>=0;b--)this.observers[b](this);return this},ignore:function(a){return this.observers=this.observers.filter(function(b){return b!==a}),this},dirty:function(){for(var a=["__cachedLength","__cachedLengthSquared"],b=0,c=a.length;c>b;b++)this[a[b]]=null},set:function(a,b){return a=d.clean(a),b=d.clean(b),this.x===a&&this.y===b?this:(this.x=a,this.y=b,this.dirty(),this.change())},zero:function(){return this.set(0,0)},clone:function(){return new d(this.x,this.y)},negate:function(a){return a?new d(-this.x,-this.y):this.set(-this.x,-this.y)},add:function(a,b){return b?new d(this.x+a.x,this.y+a.y):this.set(this.x+a.x,this.y+a.y)},subtract:function(a,b){return b?new d(this.x-a.x,this.y-a.y):(this.x-=a.x,this.y-=a.y,this)},multiply:function(a,b){var e,f;return a.x!==c?(e=a.x,f=a.y):e=f=a,b?new d(this.x*e,this.y*f):this.set(this.x*e,this.y*f)},rotate:function(a,b,c){var i,j,e=this.x,f=this.y,g=Math.cos(a),h=Math.sin(a);return b=b?-1:1,i=g*e-b*h*f,j=b*h*e+g*f,c?new d(i,j):this.set(i,j)},__cachedLength:null,length:function(){if(null===this.__cachedLength){var a=this.x,b=this.y;this.__cachedLength=Math.sqrt(a*a+b*b)}return this.__cachedLength},__cachedLengthSquared:null,lengthSquared:function(){if(null===this.__cachedLengthSquared){var a=this.x,b=this.y;this.__cachedLengthSquared=d.clean(a*a+b*b)}return this.__cachedLengthSquared},distance:function(a){return this.subtract(a,!0).length()},normalize:function(a){var b=this.length(),c=Number.MIN_VALUE>b?0:1/b;return a?new d(this.x*c,this.y*c):this.set(this.x*c,this.y*c)},equal:function(a,b){return b===c?this.x===a.x&&this.y==a.y:this.x===a&&this.y===b},abs:function(a){var b=Math.abs(this.x),c=Math.abs(this.y);return a?new d(b,c):this.set(b,c)},min:function(a,b){var c=this.x,e=this.y,f=a.x,g=a.y,h=f>c?c:f,i=g>e?e:g;return b?new d(h,i):this.set(h,i)},max:function(a,b){var c=this.x,e=this.y,f=a.x,g=a.y,h=c>f?c:f,i=e>g?e:g;return b?new d(h,i):this.set(h,i)},clamp:function(a,b,c){var d=this.min(b,!0).max(a);return c?d:this.set(d.x,d.y)},lerp:function(a,b){return this.add(a.subtract(this,!0).multiply(b),!0)},skew:function(){return new d(-this.y,this.x)},dot:function(a){return d.clean(this.x*a.x+a.y*this.y)},perpDot:function(a){return d.clean(this.x*a.y-this.y*a.x)},angleTo:function(a){return Math.atan2(this.perpDot(a),this.dot(a))},divide:function(a,b){if(0===a||isNaN(a))throw Error("division by zero");return b?new d(this.x/a,this.y/a):this.set(this.x/a,this.y/a)},toArray:function(){return[this.x,this.y]},fromArray:function(a){return this.set(a[0],a[1])}},d.fromArray=function(a){return new d(a[0],a[1])},d.precision=b||8;var e=Math.pow(10,d.precision);return d.clean=a||function(a){if(isNaN(a))throw Error("NaN detected");if(!isFinite(a))throw Error("Infinity detected");return Math.round(a)===a?a:Math.round(a*e)/e},d.inject=inject,"undefined"!=typeof module&&"object"==typeof module.exports?module.exports=d:window.Vec2=window.Vec2||d,d})();